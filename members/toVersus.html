<!DOCTYPE html><html lang="ja"><head><meta charSet="utf-8" data-next-head=""/><meta name="viewport" content="width=device-width" data-next-head=""/><link rel="icon shortcut" type="image/png" href="https://blog.3-shake.com/logo.png" data-next-head=""/><title data-next-head="">Tsubasa Nagasawa | 3-shake Engineers&#x27; Blogs</title><meta property="og:title" content="Tsubasa Nagasawa" data-next-head=""/><meta property="og:url" content="https://blog.3-shake.com/members/toVersus" data-next-head=""/><meta name="twitter:card" content="summary_large_image" data-next-head=""/><meta property="og:site" content="3-shake Engineers&#x27; Blogs" data-next-head=""/><meta property="og:image" content="https://blog.3-shake.com/og.png" data-next-head=""/><link rel="canonical" href="https://blog.3-shake.com/members/toVersus" data-next-head=""/><link rel="preload" href="/_next/static/css/683b82a315c74ead.css" as="style"/><link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;500;700&amp;family=Roboto:wght@300;400;500;700&amp;display=swap" rel="stylesheet"/><link rel="stylesheet" href="/_next/static/css/683b82a315c74ead.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" noModule="" src="/_next/static/chunks/polyfills-42372ed130431b0a.js"></script><script src="/_next/static/chunks/webpack-6ffd07a3317375c1.js" defer=""></script><script src="/_next/static/chunks/framework-b1e5f14688f9ffe6.js" defer=""></script><script src="/_next/static/chunks/main-185e55058f08a063.js" defer=""></script><script src="/_next/static/chunks/pages/_app-eb27c9050fc0d186.js" defer=""></script><script src="/_next/static/chunks/736-bba5fc77a86269c3.js" defer=""></script><script src="/_next/static/chunks/pages/members/%5Bid%5D-1cb8738aa03f0d9c.js" defer=""></script><script src="/_next/static/SdB9jjSmkc6jIzFN-XB_-/_buildManifest.js" defer=""></script><script src="/_next/static/SdB9jjSmkc6jIzFN-XB_-/_ssgManifest.js" defer=""></script></head><body><link rel="preload" as="image" href="/logo.svg"/><link rel="preload" as="image" href="/avatars/toVersus.png"/><link rel="preload" as="image" href="/icons/twitter.svg"/><link rel="preload" as="image" href="/icons/github.svg"/><link rel="preload" as="image" href="https://www.google.com/s2/favicons?domain=zenn.dev"/><link rel="preload" as="image" href="https://www.google.com/s2/favicons?domain=qiita.com"/><div id="__next"><header class="site-header"><div class="content-wrapper"><div class="site-header__inner"><a class="site-header__logo-link" href="/"><img src="/logo.svg" alt="3-shake Engineers&#x27; Blogs" class="site-header__logo-img"/><span class="site-header__logo-text">3-shake<br/>Engineers&#x27; Blogs</span></a><div class="site-header__links"><a class="site-header__link" href="/feed.xml">RSS</a><a href="https://jobs-3-shake.com/" class="site-header__link">Recruit</a><a href="https://3-shake.com/" class="site-header__link">Company</a></div></div></div></header><section class="member"><div class="content-wrapper"><header class="member-header"><div class="member-header__avatar"><img src="/avatars/toVersus.png" alt="Tsubasa Nagasawa" width="100" height="100" class="member-header__avatar-img"/></div><h1 class="member-header__name">Tsubasa Nagasawa</h1><p class="member-header__bio">lazy programmer</p><div class="member-header__links"><a href="https://twitter.com/toversus26" class="member-header__link"><img src="/icons/twitter.svg" alt="Twitterのユーザー@toversus26" width="22" height="22"/></a><a href="https://github.com/toVersus" class="member-header__link"><img src="/icons/github.svg" alt="GitHubのユーザー@toVersus" width="22" height="22"/></a></div></header><div class="member-posts-container"><div class="post-list"><article class="post-link"><a class="post-link__author" href="/members/toVersus"><img src="/avatars/toVersus.png" class="post-link__author-img" width="35" height="35"/><div class="post-link__author-name"><div class="post-link__author-name">Tsubasa Nagasawa</div><time dateTime="2024-10-14T07:39:56.000Z" class="post-link__date">a year ago</time></div></a><a href="https://zenn.dev/toversus/articles/d78254ad757094" class="post-link__main-link"><h2 class="post-link__title">[Sidecar Containers] Pod Eviction 時のメッセージの改善</h2><div class="post-link__site"><img src="https://www.google.com/s2/favicons?domain=zenn.dev" width="14" height="14" class="post-link__site-favicon"/>zenn.dev</div></a></article><article class="post-link"><a class="post-link__author" href="/members/toVersus"><img src="/avatars/toVersus.png" class="post-link__author-img" width="35" height="35"/><div class="post-link__author-name"><div class="post-link__author-name">Tsubasa Nagasawa</div><time dateTime="2024-05-16T23:43:33.000Z" class="post-link__date">a year ago</time></div></a><a href="https://zenn.dev/toversus/articles/dcb888d73f0615" class="post-link__main-link"><h2 class="post-link__title">[Kubernetes 1.30] kube-proxy の nftables モード</h2><div class="post-link__site"><img src="https://www.google.com/s2/favicons?domain=zenn.dev" width="14" height="14" class="post-link__site-favicon"/>zenn.dev</div></a></article><article class="post-link"><a class="post-link__author" href="/members/toVersus"><img src="/avatars/toVersus.png" class="post-link__author-img" width="35" height="35"/><div class="post-link__author-name"><div class="post-link__author-name">Tsubasa Nagasawa</div><time dateTime="2024-04-30T06:43:41.000Z" class="post-link__date">a year ago</time></div></a><a href="https://zenn.dev/toversus/articles/5bbd68e507f28d" class="post-link__main-link"><h2 class="post-link__title">[Kubernetes 1.30] Dynamic Resource Allocation の再構築</h2><div class="post-link__site"><img src="https://www.google.com/s2/favicons?domain=zenn.dev" width="14" height="14" class="post-link__site-favicon"/>zenn.dev</div></a></article><article class="post-link"><a class="post-link__author" href="/members/toVersus"><img src="/avatars/toVersus.png" class="post-link__author-img" width="35" height="35"/><div class="post-link__author-name"><div class="post-link__author-name">Tsubasa Nagasawa</div><time dateTime="2024-04-17T00:22:38.000Z" class="post-link__date">a year ago</time></div></a><a href="https://zenn.dev/toversus/articles/a4bbd2047bbba1" class="post-link__main-link"><h2 class="post-link__title">[EKS] Amazon Linux 2023 への移行</h2><div class="post-link__site"><img src="https://www.google.com/s2/favicons?domain=zenn.dev" width="14" height="14" class="post-link__site-favicon"/>zenn.dev</div></a></article><article class="post-link"><a class="post-link__author" href="/members/toVersus"><img src="/avatars/toVersus.png" class="post-link__author-img" width="35" height="35"/><div class="post-link__author-name"><div class="post-link__author-name">Tsubasa Nagasawa</div><time dateTime="2023-12-13T00:43:43.000Z" class="post-link__date">2 years ago</time></div></a><a href="https://zenn.dev/toversus/articles/88ce2ea66b532d" class="post-link__main-link"><h2 class="post-link__title">[Kubernetes 1.27] Pod 停止時のフェーズ遷移の変更</h2><div class="post-link__site"><img src="https://www.google.com/s2/favicons?domain=zenn.dev" width="14" height="14" class="post-link__site-favicon"/>zenn.dev</div></a></article><article class="post-link"><a class="post-link__author" href="/members/toVersus"><img src="/avatars/toVersus.png" class="post-link__author-img" width="35" height="35"/><div class="post-link__author-name"><div class="post-link__author-name">Tsubasa Nagasawa</div><time dateTime="2023-11-27T08:23:13.000Z" class="post-link__date">2 years ago</time></div></a><a href="https://zenn.dev/toversus/articles/791c7916e21059" class="post-link__main-link"><h2 class="post-link__title">KEP-4188: New kubelet gRPC API with endpoint returning local pods info</h2><div class="post-link__site"><img src="https://www.google.com/s2/favicons?domain=zenn.dev" width="14" height="14" class="post-link__site-favicon"/>zenn.dev</div></a></article><article class="post-link"><a class="post-link__author" href="/members/toVersus"><img src="/avatars/toVersus.png" class="post-link__author-img" width="35" height="35"/><div class="post-link__author-name"><div class="post-link__author-name">Tsubasa Nagasawa</div><time dateTime="2023-07-20T10:18:32.000Z" class="post-link__date">2 years ago</time></div></a><a href="https://zenn.dev/toversus/articles/52b107ab103712" class="post-link__main-link"><h2 class="post-link__title">Kubernetes の upstream のキャッチアップ</h2><div class="post-link__site"><img src="https://www.google.com/s2/favicons?domain=zenn.dev" width="14" height="14" class="post-link__site-favicon"/>zenn.dev</div></a></article><article class="post-link"><a class="post-link__author" href="/members/toVersus"><img src="/avatars/toVersus.png" class="post-link__author-img" width="35" height="35"/><div class="post-link__author-name"><div class="post-link__author-name">Tsubasa Nagasawa</div><time dateTime="2023-06-08T03:46:32.000Z" class="post-link__date">2 years ago</time></div></a><a href="https://zenn.dev/toversus/articles/d6065bea460871" class="post-link__main-link"><h2 class="post-link__title">Kubernetes 1.27 以降のバッチ処理の改善</h2><div class="post-link__site"><img src="https://www.google.com/s2/favicons?domain=zenn.dev" width="14" height="14" class="post-link__site-favicon"/>zenn.dev</div></a></article><article class="post-link"><a class="post-link__author" href="/members/toVersus"><img src="/avatars/toVersus.png" class="post-link__author-img" width="35" height="35"/><div class="post-link__author-name"><div class="post-link__author-name">Tsubasa Nagasawa</div><time dateTime="2023-05-11T09:43:47.000Z" class="post-link__date">2 years ago</time></div></a><a href="https://zenn.dev/toversus/articles/1682d275ef1bb7" class="post-link__main-link"><h2 class="post-link__title">Connection draining for Service type LoadBalancer</h2><div class="post-link__site"><img src="https://www.google.com/s2/favicons?domain=zenn.dev" width="14" height="14" class="post-link__site-favicon"/>zenn.dev</div></a></article><article class="post-link"><a class="post-link__author" href="/members/toVersus"><img src="/avatars/toVersus.png" class="post-link__author-img" width="35" height="35"/><div class="post-link__author-name"><div class="post-link__author-name">Tsubasa Nagasawa</div><time dateTime="2023-05-06T02:11:55.000Z" class="post-link__date">2 years ago</time></div></a><a href="https://zenn.dev/toversus/articles/fe2aa06f133b49" class="post-link__main-link"><h2 class="post-link__title">[Kubernetes 1.27] Dynamic Resource Allocation のいま</h2><div class="post-link__site"><img src="https://www.google.com/s2/favicons?domain=zenn.dev" width="14" height="14" class="post-link__site-favicon"/>zenn.dev</div></a></article><article class="post-link"><a class="post-link__author" href="/members/toVersus"><img src="/avatars/toVersus.png" class="post-link__author-img" width="35" height="35"/><div class="post-link__author-name"><div class="post-link__author-name">Tsubasa Nagasawa</div><time dateTime="2023-04-10T02:20:29.000Z" class="post-link__date">3 years ago</time></div></a><a href="https://zenn.dev/toversus/articles/5d1292160f5035" class="post-link__main-link"><h2 class="post-link__title">Kubernetes の Probe の仕組みと考慮点</h2><div class="post-link__site"><img src="https://www.google.com/s2/favicons?domain=zenn.dev" width="14" height="14" class="post-link__site-favicon"/>zenn.dev</div></a></article><article class="post-link"><a class="post-link__author" href="/members/toVersus"><img src="/avatars/toVersus.png" class="post-link__author-img" width="35" height="35"/><div class="post-link__author-name"><div class="post-link__author-name">Tsubasa Nagasawa</div><time dateTime="2023-03-29T01:31:20.000Z" class="post-link__date">3 years ago</time></div></a><a href="https://zenn.dev/toversus/articles/6eeb3b708bdff3" class="post-link__main-link"><h2 class="post-link__title">kube-proxy の externalTrafficPolicy=Local の改善</h2><div class="post-link__site"><img src="https://www.google.com/s2/favicons?domain=zenn.dev" width="14" height="14" class="post-link__site-favicon"/>zenn.dev</div></a></article><article class="post-link"><a class="post-link__author" href="/members/toVersus"><img src="/avatars/toVersus.png" class="post-link__author-img" width="35" height="35"/><div class="post-link__author-name"><div class="post-link__author-name">Tsubasa Nagasawa</div><time dateTime="2023-03-22T07:36:38.000Z" class="post-link__date">3 years ago</time></div></a><a href="https://zenn.dev/toversus/articles/d9faba80f68ea2" class="post-link__main-link"><h2 class="post-link__title">Kubernetes と名前解決</h2><div class="post-link__site"><img src="https://www.google.com/s2/favicons?domain=zenn.dev" width="14" height="14" class="post-link__site-favicon"/>zenn.dev</div></a></article><article class="post-link"><a class="post-link__author" href="/members/toVersus"><img src="/avatars/toVersus.png" class="post-link__author-img" width="35" height="35"/><div class="post-link__author-name"><div class="post-link__author-name">Tsubasa Nagasawa</div><time dateTime="2023-03-05T14:17:49.000Z" class="post-link__date">3 years ago</time></div></a><a href="https://zenn.dev/toversus/articles/8557a7fb2bc15c" class="post-link__main-link"><h2 class="post-link__title">振り返り (2020 - 2022)</h2><div class="post-link__site"><img src="https://www.google.com/s2/favicons?domain=zenn.dev" width="14" height="14" class="post-link__site-favicon"/>zenn.dev</div></a></article><article class="post-link"><a class="post-link__author" href="/members/toVersus"><img src="/avatars/toVersus.png" class="post-link__author-img" width="35" height="35"/><div class="post-link__author-name"><div class="post-link__author-name">Tsubasa Nagasawa</div><time dateTime="2021-10-23T08:20:56.000Z" class="post-link__date">4 years ago</time></div></a><a href="https://qiita.com/toVersus/items/4ff2525d562d8de4d530" class="post-link__main-link"><h2 class="post-link__title">GKE CNI Deep Dive (2021)</h2><div class="post-link__site"><img src="https://www.google.com/s2/favicons?domain=qiita.com" width="14" height="14" class="post-link__site-favicon"/>qiita.com</div></a></article><article class="post-link"><a class="post-link__author" href="/members/toVersus"><img src="/avatars/toVersus.png" class="post-link__author-img" width="35" height="35"/><div class="post-link__author-name"><div class="post-link__author-name">Tsubasa Nagasawa</div><time dateTime="2020-06-14T05:05:07.000Z" class="post-link__date">5 years ago</time></div></a><a href="https://qiita.com/toVersus/items/5316e94490d60c220af7" class="post-link__main-link"><h2 class="post-link__title">Handy Admission Webhook Library</h2><div class="post-link__site"><img src="https://www.google.com/s2/favicons?domain=qiita.com" width="14" height="14" class="post-link__site-favicon"/>qiita.com</div></a></article><article class="post-link"><a class="post-link__author" href="/members/toVersus"><img src="/avatars/toVersus.png" class="post-link__author-img" width="35" height="35"/><div class="post-link__author-name"><div class="post-link__author-name">Tsubasa Nagasawa</div><time dateTime="2019-12-18T22:00:21.000Z" class="post-link__date">6 years ago</time></div></a><a href="https://qiita.com/toVersus/items/1317a31fead9b836a68d" class="post-link__main-link"><h2 class="post-link__title">Knative Serving in Production</h2><div class="post-link__site"><img src="https://www.google.com/s2/favicons?domain=qiita.com" width="14" height="14" class="post-link__site-favicon"/>qiita.com</div></a></article><article class="post-link"><a class="post-link__author" href="/members/toVersus"><img src="/avatars/toVersus.png" class="post-link__author-img" width="35" height="35"/><div class="post-link__author-name"><div class="post-link__author-name">Tsubasa Nagasawa</div><time dateTime="2019-10-23T13:20:58.000Z" class="post-link__date">6 years ago</time></div></a><a href="https://qiita.com/toVersus/items/9fa635e9cf57643f8dd6" class="post-link__main-link"><h2 class="post-link__title">Zero Scale Abstraction in Knative Serving - Part1</h2><div class="post-link__site"><img src="https://www.google.com/s2/favicons?domain=qiita.com" width="14" height="14" class="post-link__site-favicon"/>qiita.com</div></a></article></div></div></div></section><footer class="site-footer"><div class="content-wrapper"><p>© <!-- -->3-shake Inc.</p></div></footer></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"member":{"id":"toVersus","name":"Tsubasa Nagasawa","role":"SRE","bio":"lazy programmer","avatarSrc":"/avatars/toVersus.png","sources":["https://qiita.com/toVersus/feed","https://zenn.dev/toversus/feed"],"includeUrlRegex":"","twitterUsername":"toversus26","githubUsername":"toVersus","websiteUrl":""},"postItems":[{"title":"[Sidecar Containers] Pod Eviction 時のメッセージの改善","link":"https://zenn.dev/toversus/articles/d78254ad757094","contentSnippet":"はじめに先日 Kubernetes で報告されていたバグを修正する PR を送りました。その時に、今後 Kubernetes へのコントリビュートを考えている方の参考になればと思い、どう取り組んだか (Issue の読み解き方やローカル環境での再現、コードの修正、テストの追加などの一通りの流れ) を脳内ダンプして言語化してみました。それを社内向けに共有していたのですが、PR も無事にマージされたので、一部加筆修正して記事として公開します。Issue: [Sidecar Containers] Eviction message should account for the sid...","isoDate":"2024-10-14T07:39:56.000Z","dateMiliSeconds":1728891596000,"authorName":"Tsubasa Nagasawa","authorId":"toVersus"},{"title":"[Kubernetes 1.30] kube-proxy の nftables モード","link":"https://zenn.dev/toversus/articles/dcb888d73f0615","contentSnippet":"kube-proxyService へのトラフィックをプロキシするコンポーネントのデフォルト実装e.g.) Cluster IP への通信を Pod IP にリダイレクトするEndpointSlice, Service, Node などのオブジェクトの変更を検知して Service を介したトラフィックのルーティングを可能にするContainer Network Interface (CNI) vs kube-proxyCNI が Pod 間で通信できるように Pod IP の払い出しやルーティングをセットアップするPod は一時的なものかつ Pod ...","isoDate":"2024-05-16T23:43:33.000Z","dateMiliSeconds":1715903013000,"authorName":"Tsubasa Nagasawa","authorId":"toVersus"},{"title":"[Kubernetes 1.30] Dynamic Resource Allocation の再構築","link":"https://zenn.dev/toversus/articles/5bbd68e507f28d","contentSnippet":"!Kubernetes 1.30 時点でアルファ機能のため、実装が大きく変わる可能性があります。[Kubernetes 1.27] Dynamic Resource Allocation のいまで紹介した Dynamic Resource Allocation (DRA) の内部的な仕組みに Kubernetes 1.30 で大きく変更が入ることになりました。内部的な仕組みの変更なので、ユーザー視点ではこれまでと利用方法は変わりません。ResourceClass に追加されたフィールドを有効にしないと新しい仕組みが使えないため、クラスタ管理者は対応が必要になります。世界的に AI...","isoDate":"2024-04-30T06:43:41.000Z","dateMiliSeconds":1714459421000,"authorName":"Tsubasa Nagasawa","authorId":"toVersus"},{"title":"[EKS] Amazon Linux 2023 への移行","link":"https://zenn.dev/toversus/articles/a4bbd2047bbba1","contentSnippet":"2024/2/29 に Amazon Linux 2023 が EKS で正式サポートされました。全てのリージョンの Karpenter Node、マネージドノードグループ、セルフマネージドノードグループで利用可能です。現在 EKS でサポート対象の 1.25 以降に加えて、延長サポートに入っている EKS 1.23 / 1.24 でも利用できます。Amazon Linux 2023 のサポートに関しては Amazon EKS-Optimized Amazon Linux 2023 AMIs Now Available のブログに詳細がまとまっています。 セキュリティ機能の強化Am...","isoDate":"2024-04-17T00:22:38.000Z","dateMiliSeconds":1713313358000,"authorName":"Tsubasa Nagasawa","authorId":"toVersus"},{"title":"[Kubernetes 1.27] Pod 停止時のフェーズ遷移の変更","link":"https://zenn.dev/toversus/articles/88ce2ea66b532d","contentSnippet":"Kubernetes 1.27 で KEP-3329: Retriable and non-retriable Pod failures for Jobs の一部として実装された [k/k#115331]: Give terminal phase correctly to all pods that will not be restarted により、Pod 停止時のフェーズが Running から Succeeded か Failed に遷移するようになりました。しかし、この変更が以下の予期せぬ問題を引き起こすことになります。[k/k#117018]: daemonset stuc...","isoDate":"2023-12-13T00:43:43.000Z","dateMiliSeconds":1702428223000,"authorName":"Tsubasa Nagasawa","authorId":"toVersus"},{"title":"KEP-4188: New kubelet gRPC API with endpoint returning local pods info","link":"https://zenn.dev/toversus/articles/791c7916e21059","contentSnippet":"!KEP 持ち寄り会 #1 の登壇資料です。2023/11/27 時点の KEP-4188 の内容です。Kubernetes 1.29 時点で機能として入っていないので注意して下さい。また、後半の文章は考察を含んでおり、正確な情報でない可能性があります。 概要KEP-4188 は、Kubelet に Pod Conditions を公開する gRPC API を追加する KEP です。Pod Conditions は Status フィールドに含まれています。❯ kubectl get pods -n kube-system coredns-5d78c9869d-8gglh ...","isoDate":"2023-11-27T08:23:13.000Z","dateMiliSeconds":1701073393000,"authorName":"Tsubasa Nagasawa","authorId":"toVersus"},{"title":"Kubernetes の upstream のキャッチアップ","link":"https://zenn.dev/toversus/articles/52b107ab103712","contentSnippet":"先日、Kubernetes Meetup Tokyo #59 で「KEP から眺める Kubernetes」というタイトルで発表しました。発表の後で Kubernetes の upstream のキャッチアップ方法について質問を受けました。その場で回答はしたのですが、ちょうど社内の共有会で似たような話をしたところだったので、加筆修正したものを公開しておきます。 はじめにKubernetes の upstream を追いかけ始めて 1 年ちょっと経ったので、その経験をまとめます。Kubernetes の upstream やエコシステムを観察しているだけで、コントリビュータではありま...","isoDate":"2023-07-20T10:18:32.000Z","dateMiliSeconds":1689848312000,"authorName":"Tsubasa Nagasawa","authorId":"toVersus"},{"title":"Kubernetes 1.27 以降のバッチ処理の改善","link":"https://zenn.dev/toversus/articles/d6065bea460871","contentSnippet":"Kubernetes 1.27 以降で実装済みまたは予定されているバッチ処理の改善に繋がる KEP や Kubernetes のサブプロジェクトの現状を見ていきます。 KEP-3673: Kubelet limit of Parallel Image Pulls!Kubernetes 1.27 時点でアルファ機能です。1.28 でベータを目指していますが、設定はデフォルトで無効化されています。Pod の起動にノードのスケールアウトが必要な場合に、Pod の起動時間の短縮が期待できます。バッチ処理の Pod が一斉に起動するケースで恩恵を受けられそうです。Kubelet は...","isoDate":"2023-06-08T03:46:32.000Z","dateMiliSeconds":1686195992000,"authorName":"Tsubasa Nagasawa","authorId":"toVersus"},{"title":"Connection draining for Service type LoadBalancer","link":"https://zenn.dev/toversus/articles/1682d275ef1bb7","contentSnippet":"はじめにService リソースは Kubernetes のサービス検出を支えるコアリソースです。Service のデータプレーンとして kube-proxy を使用している場合は、各ノード上の iptables や ipvs を設定することで L4 負荷分散を実現しています。Kubernetes は、結果整合性 (Eventual Consistency) の上に成り立つ分散システムです。Kubernetes のコントロールプレーンが Pod を削除する時に、全てのノード上のルーティングルールを更新してから Pod を削除したりはしません。削除中の Pod にもトラフィックが流...","isoDate":"2023-05-11T09:43:47.000Z","dateMiliSeconds":1683798227000,"authorName":"Tsubasa Nagasawa","authorId":"toVersus"},{"title":"[Kubernetes 1.27] Dynamic Resource Allocation のいま","link":"https://zenn.dev/toversus/articles/fe2aa06f133b49","contentSnippet":"!Kubernetes 1.27 時点でアルファ機能のため、実装が大きく変わる可能性があります。 はじめにKubeCon Europe 2023 で KEP-3063 Dynamic Resource Allocation (DRA) についての深い話と DRA Resource Driver の実装方法の話があったので、kubernetes-sigs/dra-example-driver をベースに触りながら検証してみました。toVersus/fake-dra-driver で公開しています。Device Plugins 2.0: How to Build a Drive...","isoDate":"2023-05-06T02:11:55.000Z","dateMiliSeconds":1683339115000,"authorName":"Tsubasa Nagasawa","authorId":"toVersus"},{"title":"Kubernetes の Probe の仕組みと考慮点","link":"https://zenn.dev/toversus/articles/5d1292160f5035","contentSnippet":"!Kubernetes 1.26 時点の話で、以降のマイナーバージョンで改善されている可能性があります。Kubernetes には、ワークロードの正常性を確認するための Probe という仕組みがあり、Liveness / Readiness / Startup Probe が用意されています。kubelet (Kubernetes のノード上で動作するエージェント) は、ワークロードに対して TCP Socket / HTTP GET / gRPC / Exec の中から指定されたチェックを定期的に実行します。それぞれの Probe の特性を理解して使い分けないとサービスに影響...","isoDate":"2023-04-10T02:20:29.000Z","dateMiliSeconds":1681093229000,"authorName":"Tsubasa Nagasawa","authorId":"toVersus"},{"title":"kube-proxy の externalTrafficPolicy=Local の改善","link":"https://zenn.dev/toversus/articles/6eeb3b708bdff3","contentSnippet":"tl;dr;Service type LoadBalancer の externalTrafficPolicy: Local は、Kubernetes 1.26 まで Pod のローリング更新時にトラフィックが喪失する問題があるので注意kubernetes-sigs/cloud-provider-kind は、ローカル環境でクラウドリソース (現在は LB のみ) が絡む処理をシミュレートできて便利GKE Dataplane v2 を利用している場合、GKE 1.26.1 時点で Cilium に externalTrafficPolicy: Local の改善が入ってい...","isoDate":"2023-03-29T01:31:20.000Z","dateMiliSeconds":1680053480000,"authorName":"Tsubasa Nagasawa","authorId":"toVersus"},{"title":"Kubernetes と名前解決","link":"https://zenn.dev/toversus/articles/d9faba80f68ea2","contentSnippet":"tl;dr外部サービスのホスト名の末尾に . (ドット) を必ず指定しましょう。✅ google.com.❌ google.com末尾にドットを指定できない (e.g. SDK 組み込み) かつ大量の名前解決が発生している場合は、Pod の DNS Config の options で ndots: 1 を指定しましょう。Kubernetes の名前解決の仕組みを理解していないと、各ノードの conntrack テーブルが溢れてパケットが破棄され、サービスに影響が出ることがあります。 背景アプリケーションが外部のサービスを呼び出す場合、ホスト名を IP アド...","isoDate":"2023-03-22T07:36:38.000Z","dateMiliSeconds":1679470598000,"authorName":"Tsubasa Nagasawa","authorId":"toVersus"},{"title":"振り返り (2020 - 2022)","link":"https://zenn.dev/toversus/articles/8557a7fb2bc15c","contentSnippet":"コロプラに 2020/3/1 に入社して、2023/2/28 付けで退職したので、丸々 3 年間勤務したことになります。本当の意味での大規模 Kubernetes 環境で貴重な経験をさせて貰い感謝しかないです。記憶が新しい内に、この 3 年間でやってきたことを公開できる範囲で整理しました。 GitOps 風なマニフェスト管理への移行インフラチームで管理している監視ツールやアドオンなコンポーネントを Helm でインストールしていました。マルチクラスタな環境で手動インストールはスケールしないので、Helmfile で生成した各クラスタのマニフェストを Argo CD で同期する方式に...","isoDate":"2023-03-05T14:17:49.000Z","dateMiliSeconds":1678025869000,"authorName":"Tsubasa Nagasawa","authorId":"toVersus"},{"title":"GKE CNI Deep Dive (2021)","link":"https://qiita.com/toVersus/items/4ff2525d562d8de4d530","contentSnippet":"GKE (Google Kubernetes Engine) のネットワーク周りの実装はユーザーの見えないところで変化を続けています。以前は、公式ドキュメントにあるように bridge interface (cbr0) を介してホストマシン (ノード) とコンテナ間でパケッ...","isoDate":"2021-10-23T08:20:56.000Z","dateMiliSeconds":1634977256000,"authorName":"Tsubasa Nagasawa","authorId":"toVersus"},{"title":"Handy Admission Webhook Library","link":"https://qiita.com/toVersus/items/5316e94490d60c220af7","contentSnippet":"Kubernetes の Admission Webhook を開発する際に、kubernetes/api をラップした軽量なライブラリやフレームワークを使うことがあると思います。kubernetes-sigs/controller-runtimeslok/kubew...","isoDate":"2020-06-14T05:05:07.000Z","dateMiliSeconds":1592111107000,"authorName":"Tsubasa Nagasawa","authorId":"toVersus"},{"title":"Knative Serving in Production","link":"https://qiita.com/toVersus/items/1317a31fead9b836a68d","contentSnippet":"概要Knative Serving は、ステートレスなアプリケーションを対象に、HTTP リクエスト駆動で自動スケールする仕組みを提供します。Kubernetes (K8s) と Ingress (Istio or Gloo, Ambassader) を程よく抽象化し、...","isoDate":"2019-12-18T22:00:21.000Z","dateMiliSeconds":1576706421000,"authorName":"Tsubasa Nagasawa","authorId":"toVersus"},{"title":"Zero Scale Abstraction in Knative Serving - Part1","link":"https://qiita.com/toVersus/items/9fa635e9cf57643f8dd6","contentSnippet":"Serverless Days Tokyo 2019 の Zero Scale Abstraction in Knative Serving というセッションの内容を書き起こしたものです。スピーカーノートをベースに、セッションの時間内で話せなかった内容も含めて、Knativ...","isoDate":"2019-10-23T13:20:58.000Z","dateMiliSeconds":1571836858000,"authorName":"Tsubasa Nagasawa","authorId":"toVersus"}]},"__N_SSG":true},"page":"/members/[id]","query":{"id":"toVersus"},"buildId":"SdB9jjSmkc6jIzFN-XB_-","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>